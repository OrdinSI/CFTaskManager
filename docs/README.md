# Архитектурное описание CFTaskManager

## Описание

CFTaskManager — это приложение для автоматизации работы с задачами Codeforces, включающее в себя парсинг данных, их хранение и взаимодействие с пользователями через Telegram-бот.

## Хранилище

- `/mnt/postgres/postgres-data` - данные базы данных PostgreSQL;


## Компоненты инфраструктуры

- **PostgreSQL** - основное хранилище данных;
- **Docker** - контейнеризация приложения для обеспечения портативности и изоляции.

## Контейнеры сервиса

### App Container (Приложение)

Управляет основными функциями проекта, включает в себя:

- `src/bot/` - бот Telegram на aiogram3:
    - `controllers/` - обработчики сообщений и команд бота, основная логика приложения.
    - `models/` - взаимодействие с базой данных.
    - `views/` - интерфейс для общения с пользователями и создание клавиатур.
- `src/db/` - база данных через ORM Tortoise:
    - `models/` - модели данных;
    - `migrations/` - файлы миграций;
    - `utils/` - утилиты для работы с базой данных.
- `src/parser/` - парсер, использующий Selenium:
    - `codeforces/` - основная логика парсинга сайта;
    - `utils/` - утилита для работы с заголовками (headers) через Selenium.
- `settings.py` - настройка всего приложения.

### DB Container (База данных)

- **PostgreSQL** - основное хранилище данных проекта.

## Взаимодействие компонентов

### Основные потоки данных

1. **Парсинг и сохранение данных:**
    - Парсер, использующий Selenium, получает задачи с сайта Codeforces.
    - Сохранение полученных данных в PostgreSQL через ORM Tortoise.

2. **Telegram-бот:**
    - Пользователь взаимодействует с ботом, который использует обработчики для обработки команд и сообщений в `controllers/`.
    - Бот выполняет запросы к базе данных через `models/` для получения или сохранения информации.
    - Бот взаимодействует с пользователем через `views/`, используя send_message и клавиатуры.

## Технологии и инструменты

- **Docker** - обеспечивает контейнеризацию и изоляцию микросервисов.
- **PostgreSQL** - реляционная база данных для хранения структурированных данных.
- **aiogram3** - библиотека для создания взаимодействий с Telegram.
- **Tortoise ORM** - библиотека для ORM-моделирования данных в Python.
- **Selenium** - инструмент для автоматизированного веб-тестирования и парсинга данных.
- **APScheduler** - библиотека для планирования задач.
- **asyncio** - библиотека для написания асинхронного кода в Python.

## Заключение

Архитектура CFTaskManager спроектирована таким образом, чтобы обеспечить высокую гибкость и модульность. Каждая компонента изолирована и может быть легко заменена или масштабирована в зависимости от реальных требований.

Для более подробной информации, пожалуйста, обратитесь к основному [README.md](../README.md).